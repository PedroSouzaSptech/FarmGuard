<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> FarmGuard | Dashboard</title>
  <link rel="stylesheet" href="USUARIO.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="header">
    <div class="container">
      <h2>Dashboard </h2>
      <ul class="navbar">
        <li> <a class="navbar botao" href="inicial.html"> Home </a></li>
      </ul>
    </div>
  </div>

  <div class="avisos">
    <div class="cards">
      <h1>75%</h1>
      <p>Aviarios com Temperatura adqueada</p>
    </div>
    <div class="cards">
      <h1>20%</h1>
      <p>Aviários com temperatura em oscilação</p>
    </div>
    <div class="cards">
      <h1>5%</h1>
      <p>Aviários fora da temperatura adequada</p>
    </div>

    <div class="indicadores">
      <h2>Principais Indicadores:</h2>
      <div class="ind">
        <p id="tempCritica">Aviários com temperatura crítica: </p> <span id="img1"> <img src="IMAGENS/ok.png"></span>
      </div>
      <div class="ind">
        <p id="qtdAviarios">Aviários que permaneceram mais de 10 min fora da temperatura adequada:</p> <span id="img2">
          <img src="IMAGENS/ok.png"></span>
      </div>
      <div class="ind">
        <p id="tempAdeq"> Temperatura adequada: 22ºC a 26ºC </p> <span id="img3"> <img src="IMAGENS/ok.png"> </span>
      </div>
    </div>
  </div>

  <div class="graficos">
    <div class="sensor">
      <h2>Aviário 1</h2>
      <canvas id="grafico_sensor"></canvas>
    </div>

    <div class="media_sensor">
      <h2>Oscilação da temperatura nos últimos 5 dias</h2>
      <canvas id="grafico_media"></canvas>
    </div>

    <div class="editores_secao">

      <div class="addSecao">
        <h5>Adicionar Seção</h5>
        <img src="IMAGENS/adicionar.png">
      </div>

      <div class="editSecao">
        <h5>Editar Seção</h5>
        <img src="IMAGENS/engrenagem.png">
      </div>

    </div>
  </div>


</body>

</html>
<script>

  const gl = document.getElementById('grafico_sensor');
  new Chart(gl, {
    type: 'line',
    data: {
      labels: [],
      datasets: [{
        label: 'Temperatura',
        data: [30, 28, 26, 24, 22, 20, 18, 16, 14, 12, 10],
        borderWidth: 1,
        borderColor: '#f8c71d',
        backgroundColor: '#f8c71d',

      }
      ]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        },
      },
      plugins: {
        legend: {
          labels: {
            font: {
              size: 15,
            }
          }
        },
        // subtitle: {         -- subtitulo que pode ser util pra colocar o numero do aviario dps, caso necessario
        //         display: true,
        //         text: 'Custom Chart Subtitle'
        //     }
      }
    }
  });

  const gb = document.getElementById('grafico_media');
  new Chart(gb, {
    type: 'line',
    data: {
      labels: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'],
      datasets: [{
        label: 'Temperatura',
        data: [19.7, 22.2, 24.9, 21.4, 19.9, 23.1, 25.3],
        borderWidth: 2,
        borderColor: '#e85817',
        backgroundColor: '#f8c71d',
        textColor: '#e85817',
      }

      ]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      },
      plugins: {
        legend: {
          labels: {
            font: {
              size: 15,
            }
          }
        },
        // subtitle: {
        //         display: true,
        //         text: 'Média do total de 3 sensores'
        //     }
      }
    }
  });

  // declarando variaveis para que a imagem de alerta apareça de acordo com o número de aviários
  // considerado que o usuário tem 15 aviários
  var media = 15 / 3 // media = qtdAviarios / 3, para exibir 3 ícones diferentes de acordo com a gravidade

  // Aviários com temperatura crítica
  var numTempCritica = (Math.random() * 15).toFixed();
  tempCritica.innerHTML += ` ${numTempCritica}`;
  if (numTempCritica <= (media * 2) && numTempCritica > 0) { // se for maior que 0 e menor que 2 terços do total
    img1.innerHTML = `<img src="IMAGENS/atencao.png">`;
  }
  if (numTempCritica >= media * 2) { // se for maior que 2 terços do total
    img1.innerHTML = `<img src="IMAGENS/alertaMaximo.png">`;
  }

  // Aviários que permaneceram mais de 10 min fora da temperatura adequada
  var numAviarios = (Math.random() * 15).toFixed();
  qtdAviarios.innerHTML += ` ${numAviarios}`;
  if (numAviarios <= (media * 2) && numAviarios > 0) {
    img2.innerHTML = `<img src="IMAGENS/atencao.png">`;
  }
  if (numAviarios >= media * 2) {
    img2.innerHTML = `<img src="IMAGENS/alertaMaximo.png">`;
  }


</script>